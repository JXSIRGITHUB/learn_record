# An Architecture for Reactive Mobile Manipulation On-The-Move

一种移动中的反应式移动的操作体系结构

摘要：我们提出了一个通用的反应性移动的操作体系结构，而机器人的基础是在运动中的下一个目标，在一个高层次的任务。通过在移动中执行任务，与操作过程中底座暂停的方法相比，总体周期时间缩短。机械手的反应式控制能够以不可预测的运动抓取物体，同时与开环的基于随机性的规划方法相比，提高了对感知误差、环境干扰和不准确的机器人控制的鲁棒性。我们提出了一个示例实现的架构，并调查了一系列的拾取和放置任务的静态和动态对象的性能，并比较基线方法的性能。我们的方法在现实世界中的成功率超过99%，在物理机器人系统的120次尝试中只有一次失败。在其他移动的机械手平台上进行了仿真验证。与现有的移动的操作架构相比，我们的方法减少了高达48%的任务时间，同时还提高了可靠性，可预测性和可预测性。有关补充材料，请参见benburgesslimerick.github.io/ManipulationOnTheMove。

## 1、INTRODUCTION

移动的机械手能够在包括工业、家庭和自然空间的大型复杂环境中执行交互式任务。衡量这些机器人成功的关键是它们执行任务的速度和可靠性。此外，在需要机器人与人类一起工作的情况下，机器人的运动应该是优雅的，这被定义为安全，舒适，快速和直观[1]。

早期的移动的机械手控制体系结构将移动的基座和机械手视为两个可分离的子系统，并顺序执行任务[2]。首先将基座移动到期望的位置，然后进行操纵。最近，基座和操纵器的协调控制实现了更快、更优雅的运动[2]。然而，这些控制器通常只考虑眼前的目标。在由多个步骤组成的任务中，例如移动的拾取和放置操作，可以通过执行操纵来实现显著的速度提高，同时基座继续朝着下一个目标前进。在移动中执行任务可以实现更快、更优雅的动作。

现有的移动中操纵方法是基于计划轨迹的开环执行。在受控环境中，这种方法可以产生最佳结果。然而，当机器人必须对意外的物体运动、环境干扰、不准确的感知和不精确的机器人控制具有鲁棒性时，规划方法会导致不可靠的系统。相反，闭环，无功控制需要鲁棒性能[3]

我们提出了一种新的反应式移动的操纵的移动架构。该架构在一个真实世界的机器人上演示，该机器人使用静态和动态对象执行拾取和放置任务（图1）。所提出的体系结构的性能进行比较，现有的规划和反应控制方法的速度，可靠性和灵活性。它的通用性证明了几个不同的移动的机械手在仿真中的实现。

![image-20240126085351446](D:\project\learning\mobile_manipulation\image\image-20240126085351446.png)

我们的研究结果表明，执行任务的反应和移动的结果更快，更优雅的运动比现有的反应方法，更强大的性能比基于规划的方法。该方法对感知、定位和测距误差具有鲁棒性。我们的方法还可以在基地移动时抓住移动物体，这是现有方法不可能可靠实现的任务。所提出的架构是generalizable各种移动的机械手的设计和任务。

这项工作的贡献是：

1. 一种用于移动的操纵的体系结构，其具有对环境变化做出反应的连续基本运动。
2. 一个实现架构的拾取和放置任务，演示了抓住一个不可预测的移动物体，而整个机器人是在运动中。
3. 对超过120次试验的系统性能进行定量真实世界分析，包括与基线的比较。
4. 通过在几个模拟机器人上的实现来演示该体系结构的通用性。

## 2、RELATED WORKS

现有的移动的操纵控制架构可以被放置在从纯规划到纯反应控制的范围内的某个地方，在纯规划中，在任务开始时计算轨迹，然后在开环控制下执行，在纯反应控制中，机器人仅对当前状态做出反应，并且不考虑任务的长期计划。这种区别在频谱的中间部分变得有些模糊，其中控制器可以将全局规划器与局部反应控制器联合收割机相结合。我们认为一个反应式控制器作为一个能够实时响应机器人和环境状态的意外变化。

### A. Sequential Base-Manipulator Control

控制移动的机械手最简单的方法是将基座和机械手视为两个独立的子系统。这些组件可以通过来自移动的机器人和操纵领域的链接方法来控制。首先，机器人行驶到待操纵物体附近的目标。一旦到达，操纵器就像静态安装一样被控制。

早期的方法实现了基础和机械手控制的规划架构[2]。这些方法能够在各种环境中执行抓取和放置任务[4]-[6]。虽然规划方法非常适合于受控环境，但意外的机器人和物体运动，感知错误和不准确的机器人控制可能会导致复杂环境中的故障。

鲁棒性可以通过对臂和基座使用反应式闭环控制器来提高[7]-[9]。用于移动的操纵的顺序控制架构在速度和灵活性方面受到移动的基座在臂运动开始之前停止移动的需要的限制。

### B. Coordinated Mobile Manipulator Control

通过将移动的基座和机械手视为单一的协调控制挑战，可以提高速度和灵活性。已经提出了许多规划方法来生成高自由度移动的机械手的轨迹[10]-[13]，并且在[2]中进行了综述。规划方法可以生成无碰撞的最佳路径，但需要大量的计算时间。因此，这些系统并不适合高度动态的环境，在这种环境中，意外的变化将需要频繁的重新规划。

虽然反应控制方法不能使索赔的最优性，他们非常适合于动态环境。最近的工作提出了移动的机械手的反应协调控制方法[3]，[14]-[17]。

### C. Manipulation On-The-Move

现有的移动的操纵控制框架能够快速、优雅地完成各个任务。然而，这些方法通常不考虑如何将动作放入更高级别的任务中。例如，在拾取和放置任务中，这些方法将拾取和放置视为两个独立的动作[18]。在该示例中，通过在基座保持朝向放置位置运动的同时执行拾取，可以显著减少执行时间。由运动中的移动的机器人执行的动作也被人类感知为更“自然”和“可预测”[19]。



已经提出了几种方法，通过规划基座和操纵器的协调轨迹来实现移动中的操纵[20]-[25]。这些方法生成时间最优的优美运动[23]。然而，在所有这些工作中，开环执行计划的轨迹导致在具有高度不确定性和干扰的环境中不可靠的性能。[25]注意到，当感知不准确或机器人基座经历意外干扰时，他们的规划系统会失败。这些系统无法在高度动态的环境中操作，例如抓取移动物体。

用于移动中操纵的反应式方法将允许在动态环境中稳健、快速和优雅地执行多步任务，例如拾取和放置任务。然而，据作者所知，没有现有的方法证明反应性移动的操纵的移动。

## 3、MANIPULATION ON-THE-MOVE ARCHITECTURE-移动式操作体系结构

我们提出了一个系统，可以驱动过去的目标，同时伸出手，并执行反应性操纵任务。该系统考虑了高级任务的当前目标和下一个目标，并生成平滑连接子任务的运动。这是通过一个通用架构来实现的，该架构将控制划分为几个模块，以实现移动中的反应式操作（MotM）。所描述的架构是适合于各种各样的机器人设计，唯一的要求，**机器人提供一个速度控制接口，关节角度传感，和里程计。**在这项工作中，我们主要集中在拾取和放置任务，但其他任务，可以实现与末端执行器速度控制可以执行相同的架构。这些任务包括按下按钮、弹开开关或转动手柄。

### A. MotM Control Architecture

![image-20240126091941651](D:\project\learning\mobile_manipulation\image\image-20240126091941651.png)

图2详细说明了它们之间的各种模块和数据流。MOTM控制器有四个主要组件，它们的实现可能会根据机器人或任务的具体情况而有所不同。各组成部分的主要职责详述如下。

#### 1) Mobile Base Control

Mobile base control 负责驱动移动的基座，使得机器人在操纵目标的范围内通过，并继续朝着高级任务中的下一个目标前进。给定机器人、目标和下一个目标的当前姿态，基座控制器计算基座的期望速度并估计直到机器人在目标的操纵范围内的时间。

#### 2) MotM Reacher

当机器人接近目标时，到达器模块负责计算末端执行器速度命令，使得末端执行器在机器人到达范围内时到达目标。到达器将目标在操纵范围内之前的时间的估计作为协调末端执行器的到达的输入。

#### 3) Final-Phase Task Controller

当接近目标时，手臂控制从reacher过渡到finalphase任务控制器，该控制器计算末端执行器速度以完成任务。示例包括将末端执行器伺服到对象并执行抓取、放置对象或按下按钮。

#### 4) Arm/Base Redundancy-Resolution Control

冗余分辨率控制器负责将期望的末端执行器和基础速度转换为机器人的关节速度。该模块确保手臂和底座之间的运动协调，并可以利用冗余的自由度来实现次要任务，例如避开障碍物或最大化可操作性。



对于反应式控制，上述每个模块必须具有足够的性能，以比环境动态更快的实时速度运行。反应式控制允许这些模块对通过里程计和关节编码器观察到的干扰以及高级控制器提供的对象运动或感知更新做出反应。

### B. Implementation

我们提出了一个例子实现的各种模块执行拾取和放置任务与我们的Frankie 3移动的机械手，包括一个7度的自由度的Franka-Pandika熊猫机械手安装到欧姆龙LD 60差分驱动移动的基地。我们还部署了相同的架构在其他两个模拟平台上的最小修改的实现。

#### 1) Base Control

base control驱动机器人通过最接近的方法姿态（$\xi_{Cloest}$），这是在目标的操作范围内，并连接当前姿势到下一个目标。图3呈现了用于在给定当前基本姿态（$\xi_{Base}$）、操纵目标（$\xi_{Target}$）、下一个目标（$\xi_{Next}$）和最近接近半径（$r_{Closest}$）的情况下计算（$\xi_{Closest}$）的方法的几何表示，该计算响应于感知到的状态变化而实时更新。

![image-20240126094646504](D:\project\learning\mobile_manipulation\image\image-20240126094646504.png)

$r_{Closest}$的值由机器人半径（$r_{Robot}$）和确保目标周围间隙的填充（$r_{Padding}$）的和给出。对于实验$r_{Robot}=0.25 m$，$r_{Padding}=0.35m$，最终的最接近半径$r_{Closest}=0.6 m$。

使用[26]中提出的控制器将机器人驱动到最接近的位置$\xi_{Closest}$，该控制器计算基座的期望前进速度（$v^{*}_{Base}$）和旋转速度（$w^{*}_{Base}$）。控制器被修改为使得机器人以恒定的前进速度（$v_{Forward}$）驱动。得到的控制器由下式给出：
$$
v_{\text {Base }}^{*}=v_{\text {Forward }}, \quad \omega_{\text {Base }}^{*}=\left(k_{\alpha} \alpha+k_{\beta} \beta\right) \frac{v_{\text {Forward }}}{\rho}
$$
其中，$\alpha$是机器人当前前进方向与指向最近点的矢量之间的角度，$\beta$是期望前进方向与指向最近点的矢量之间的角度，$\rho$是指向最近点的距离（图3），$k_{\alpha}$和$k_{\beta}$是控制常数。当$k_{\alpha}>1,k_{\beta}<0$控制器稳定。选择$k_{\alpha}=4, k_{\beta} = -1.5$。

Mobile base controller估计直到机械臂在可操作范围的时间。我们考虑对于我们的机器人，在达到目标时，如果可操纵性高于 0.08 的阈值，那么该对象被认为处于操纵范围内。在我们的实验中，对于目标而言，这相当于一个操纵范围约为0.75米。然而，系统对于可操纵性阈值不太敏感，但应避免在机器人的最大可达范围内操作，以防止机器人陷入奇异性。

#### 2）MotM Reacher

启动向目标移动手臂的时间是通过计算手臂从静止位置移动到目标位置的预期运行时间来决定的。在基座标系中计算末端执行器将在其中的过渡距离，并且在基座标系中的速度由$v_{Base}K_A$给出，其中$K_A$是控制手臂移动速度的常数。增加$K_A$会延迟手臂开始运动到目标的时间，这可以最小化由于伸展手臂而导致的碰撞风险，但同时会导致手臂速度和加速度的增加，从而导致不安全的运动并降低优雅度。我们选择$K_A=0.5$的值，但我们测试的值范围为0.25至1.0，所有这些值都能产生稳定的性能。

手臂控制器为末端执行器规划一条轨迹，使其在底盘进入操作范围时抵达目标。我们使用经过分析计算的五次多项式轨迹，以最小化抖动，并且可以实时计算[26]。轨迹在每个时间步重新计算，实现对环境干扰、物体运动、感知更新和不准确的机器人控制的实时响应。所需的末端执行器速度通过计算在未来一个时间步内抵达目标的轨迹速度来确定。

在大多数情况下，在执行操作时，夹爪最好在世界坐标系中保持静止在目标位置。然而轨迹也可以生成为以指定速度抵达物体.这对于匹配移动物体的速度或以非常高的速度执行任务可能是有用的，而此时手臂无法完全补偿底盘运动.

#### 3) Final-Phase Task Controller

当夹持器接近目标时（由到目标的距离小于$d_{Task}$定义），机械臂控制切换到最终阶段任务特定控制器。我们实现了一个基于位置的伺服抓取控制器，比例增益为$K_p = 5$，最大速度由$v_{Base}K_A$ [26]给出。切换到任务控制器的距离选择为$d_{Task} = 0.1 m$。

#### 4) Arm/Base Redundancy-Resolution Controller

冗余解析控制器将期望的末端执行器和基座速度转换成关节速度和底盘的速度，同时利用冗余自由度来实现次要的目标。我们在[3]中提出的控制器增加了一个等式约束，以直接控制机器人底盘的速度。还在目标函数的线性部分添加一个额外的惩罚，与第一个手臂关节和夹持器位置之间的角度成正比。这个项使第一个关节朝向夹持器，从而在进行自上而下的抓取时提高了操作性。

将手臂和底盘的控制集成到单一的控制器中，确保这两个组件协调一致。目标速度上的松弛变量使得机器人可以在可能的情况下实现目标速度，同时避免关节限制并最大化操作性。相同的控制器还可以用于为手臂和底座添加反应式避障[27]。

#### 5) Perception System

所实现的感知系统由安装在具有宽视场的抓具的手掌中的鱼眼RGB相机组成，其确保在整个抓持过程中观察到物体。

控制夹持器取向，使得相机在接近期间指向对象，然后旋转到目标附近的自上而下的抓取位置。通过计算阈值图像中的质心来识别对象。通过相机校准将图像空间中的位置转换为来自相机的矢量。该矢量用于通过将射线与已知对象高度处的平面相交来计算3D对象位置。在这项工作中，我们假设物体高度是先验已知的，但是在未来，这将由抓取序列早期的深度相机确定。

### C. Baseline Implementations

我们实现了两个基线，反映了共同的控制架构。反应性代表[3]、[14]-[17]中提出的控制器，规划基线类似于[20]-[25]中提出的方法。

反应性基线类似于[3]中提出的，其使用二次规划优化来实现从基于位置的伺服控制器计算的末端效应器速度。我们没有在抓取后直接移动到下降姿势，而是为机器人设置了一个中间路径点，以避免与物体所在的平台发生碰撞

规划基线生成的轨迹最小化受到许多约束的末端执行器加速度。约束施加在机器人的初始条件，在预定的把握和下降时间的位置和速度的末端执行器，在一个预定的完成时间的基础和夹具的速度，最大的前进速度的基础，最小和最大的距离之间的基础和夹具，以及最小的距离之间的基础和目标。其结果是一个平滑的轨迹，执行抓在移动（OTM）。机器人伺服朝向所需的基础和夹持器姿态和速度在每一步沿着轨迹。对于这个控制器的把握姿态是固定的轨迹生成时间。这不允许对对象运动做出任何响应，并且轨迹的有效性取决于初始感知和定位信息的准确性。对于移动对象测试用例，抓取姿势是对象的初始姿势。

## 4、EXPERIMENTS

### A. Experiment 1: Pick and Place Task

我们提出了一个可重复的拾取和放置任务比较移动的操纵控制架构。该任务包括抓住一个30 mm的红色立方体，并将其放入如图4所示的容器中。简单的对象减少了感知和抓取推理的挑战，使研究的重点仍然是控制架构。对于每个实施的方法，该任务重复10次。同样的任务是用来验证其他机器人的仿真架构的性能。动态抓取是通过用[28]中描述的平台移动物体来研究的。在10次试验中，物体以30 $mms^{-1}$的速度沿着不同的轨迹运动。物体的运动对机器人来说是未知的。

我们使用几个指标来评估性能：

#### 1) Task time (t):

从机器人开始运动到物体落下的时间。

#### 2) Success Rate (sr):

10次试验的成功率。

#### 3) Mean Transports Per Hour (MTPH): - 每小时平均运输量

平均每小时拾取次数是静态抓取系统广泛使用的指标[29]。该度量被计算为每次尝试的时间乘以成功概率的倒数，并对关于系统的速度和可靠性的信息进行编码。我们报告MTPH，它描述了在一个小时的连续操作中成功执行任务的预期数量。

#### 4）Gracefulness:

最大加速度（$max\left | \overrightarrow{a}  \right |$）已被提议作为一种度量的灵活性[1]。我们还报告了末端效应器的平均加速度幅值（$\left \langle \left | \overrightarrow{a}  \right |  \right \rangle $）。

### B. Experiment 2: Repetitive Pick and Place Task

在[3]中描述了一个更复杂，更长时间的任务，其中机器人拾取10个物体并将它们放置在3米远的地方。我们记录抓取、运输和放置每个物体的时间。我们的实验的不同之处在于，我们只抓住一个红色的立方体，而不是家居用品，以简化感知和抓取推理，这是超出了这项工作的范围。控制挑战是相同的，因此时序结果仍然提供有价值的比较。



## 5、RESULTS

##  ![image-20240126105301651](D:\project\learning\mobile_manipulation\image\image-20240126105301651.png)

### A. Experiment 1: Results

表I给出了我们的方法的真实结果和实验1的基线。我们的补充视频中包含了每个系统的试用示例视频。表一还包括三项相关工作的结果。由于缺乏已发表的性能数据，[25]的结果是根据与出版物相关的视频估计的。

与反应式基线相比，我们的方法实现了相同的可靠性，同时将执行时间减少了48%。我们的方法和反应基线是强大的感知错误和不精确的机器人控制，从而在静态抓取任务的完美成功率。然而，反应性基线在抓住物体时停止基座，这增加了任务时间。

与具有相同基本速度的方法相比，规划基线提供了略微减少的任务时间。然而，无法对不精确的感知和机器人控制做出反应，导致基线的几次错过抓握。这反映在MTPH指标中，即使限制在相同的速度下，我们的方法也会在基线上有所改进。此外，我们的方法在更高的速度下可靠地执行，从而实现最短的任务时间和最佳的MTPH

在研究的相关工作中，我们的方法改进了[3]，[23]中提出的任务时间。然而，[25]中的方法以显著更高的基本速度执行抓握。该方法在移动中执行抓取，但在抓取时不降低物体和夹具之间的相对速度。相反，抓取器在到达物体之前就开始关闭，并希望在抓取器移动经过时抓住它。相比之下，我们的方法在手指闭合时使夹持器稳定在物体上，这增加了控制和定时误差的容限，并避免对物体施加大的加速度。[25]中提出的系统在5次试验中有4次成功，其中我们的方法在30次静态抓取试验中没有失败。

我们的架构也可以用来执行抓持与夹持器和对象之间的相对速度。提供了我们的架构以0.8 ms−1的速度执行抓取的视频。然而，夹持器的缓慢闭合速度意味着成功需要闭合命令的精确定时，这难以用反应式方法实现，特别是当物体是动态的时。定时精度可以通过更快的夹持器来实现，当物体在机器人的手指之间时，夹持器能够快速靠近物体。

与我们的方法相比，在0.3 ms-1的相同基本速度下，规划基线提供了更好的精确性。在这个速度下，我们的方法的平均加速度比规划基线高8%（最大33%）。基线针对最小加速度进行了优化，我们的方法实现了类似的精确性，同时还实现了感知误差，动态环境和不精确机器人控制下的鲁棒性能。与反应式基线相比，我们的方法的基本速度为0.2 ms−1，可以在类似的时间内完成任务，但两个加速指标都降低了50%以上。

动态抓取实验证明了反应式操纵方法的价值。计划基线方法无法在任何尝试中成功抓取物体，因为物体在轨迹生成时间和抓取时间之间移动。[23]、[25]中提出的计划方法也无法执行此任务。我们的方法可以可靠地抓取动态物体，而不会影响任务时间或准确性，并且在0.4 ms−1的最高基本速度下仅出现一次故障。该故障由物体运动和错误选择的抓取姿势导致，导致物体与夹持器碰撞并从平台上脱落。这种故障模式可以通过对最后阶段任务控制器的改进来消除，而无需改变系统架构。

反应性基线也能可靠地抓取动态对象。然而，类似于静态抓取任务，反应性基线提供缓慢的任务执行，并且在相似的速度下加速度显著高于我们的方法。

### B. Experiment 2: Results

第IV-B节中描述的任务完成了六次试验，三次基本速度为0.3 ms-1，三次基本速度为0.4 ms-1，总共进行了60次运输操作。建议的系统完成了这些任务，没有失败。实验2的完整运行包含在我们的补充视频中。

在[3]中提出的系统报告了平均拾取和放置时间-定义为从开始抓取动作到放置物体的时间，但不包括返回到拾取点的时间。由于我们的方法的连续性，抓握动作没有明确的开始。相反，我们从他们的补充视频中估计从拿起一个物体到拿起下一个物体的完整往返时间。表II给出了我们的方法和[3]的结果。

![image-20240126110501170](D:\project\learning\mobile_manipulation\image\image-20240126110501170.png)

我们的方法在基本速度为0.3 ms−1时将任务时间减少了38%，在基本速度为0.4 ms−1时减少了53%。然而，重要的是要注意，我们的实验是用更简单的物体进行的，抓取是在没有混乱的情况下进行的。

虽然我们的方法没有产生任何抓取失败，但在两个实例中，底座和手臂之间的动态相互作用导致内部手臂控制器检测到幻象碰撞。突然减速所造成的欧姆龙基地的安全碰撞避免可以跳闸的碰撞扭矩限制的手臂，特别是当它是伸展。当机器人经过地板上的一个凸起时，偶尔会注意到类似的幻影碰撞。这些问题可以通过禁用基地的碰撞避免或自动清除碰撞错误来减少。然而，这些变化并没有实现，以保持机器人的安全操作。

### C. Multi-Platform Simulation Results

同样的架构和实现已经在另外两个机器人上进行了仿真测试。图5示出了在我们的模拟环境中执行移动抓取的机器人。Fetch移动的机械手具有非完整基座和7自由度手臂以及躯干提升关节。Husky平台上的UR 5手臂仅提供6个自由度。在第IV-A节中描述的拾取和放置实验是用这些机器人以各种基本速度进行的。

![image-20240126110846914](D:\project\learning\mobile_manipulation\image\image-20240126110846914.png)

图6中呈现了任务执行时间和针对基本速度的重复性度量。真实世界的Frankie的结果包括验证模拟。所有机器人在所有基本速度下的性能指标都是一致的。在Fetch和Husky + UR5机器人上部署了相同的实现，除了运动学计算所需的机器人模型外，更改很少。我们的架构在各种机器人平台上的一致性能证明了该方法的通用性。

![image-20240126110946248](D:\project\learning\mobile_manipulation\image\image-20240126110946248.png)

## 6、CONCLUSION



所提出的架构提供了一个框架反应移动的操纵的移动。我们已经提出了一个实现，它展示了类似于计划中的移动方法的高任务执行速度，但是以前只有使用较慢的反应式方法才能实现的鲁棒性。此外，我们证明了可靠的性能动态抓取任务，而在移动中，现有的方法是不可能的组合。



实验2中的重复拾取和放置任务演示了如何将该架构用作复杂的多步骤任务的一部分。不同的机器人的架构的通用性证明了在其他两个移动的机械手平台上具有不同的运动学和自由度的一致性能。



虽然我们的实验专注于在整洁的环境中抓住简单的物体，但控制模块可以进行修改，以实现避障，或在复杂的环境中执行其他任务，例如按下按钮，轻弹开关或打开门，所有这些都在移动中。所提出的架构使一系列的机会，更快，更可靠，更优雅地完成常见的操作任务。





